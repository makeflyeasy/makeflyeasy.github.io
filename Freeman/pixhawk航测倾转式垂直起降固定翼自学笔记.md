# 倾转式垂直起降固定翼装机教程
## 前言
随着垂直起降固定翼的普及，越来越多的朋友开始组装调试倾转式垂直起降固定翼。我经常收到各种各样的问题，有的问题高频出现，有的问题让我深思。所以我想找个时间结合自己的装机经验和各路朋友的问题反馈，相对系统地把自己的装机流程和心得写下来。
我主要参考了官网教程的arduplane部分，感谢Ardupilot开源飞控组织无私贡献，让我们有机会可以低成本组装自己的无人机。感谢Kris对倾转式垂直起降固定翼固件的优化，让多旋翼与固定翼之间的转换更加平稳可靠。
希望我的学习笔记能够帮助到：
泛测绘专业的学生，相信自己可以组装一台可以低成本的航测无人机，完成科研实验项目。
多旋翼航拍的朋友，这里不需要光影构图，只需要精确的POS数据和正摄影像，相信自己可以。
测绘内业的朋友，相信自己可以拿着飞机干外业 ，内外业一体，提高团队效率，创造价值。
还有无数一二线城市以外热爱无人机的城镇青年，相信自己可以通过组装无人机的技术帮助自己就业。
我认为这就是Makeflyeasy航测存在的意义，从成立至今从未改变。最后我想用“makeflyeasy航测的使命”来作为结束，提醒自己和makeflyeasy团队，不忘初心，砥砺前行！
“makeflyeasy 航测”秉持“让航测更简单”的信仰，专注于“小面积航测”，不断追求技术创新，做出简单、美丽、普世的产品，不断探索商业模式，缩短产品与用户的距离。
Makeflyeasy
20191210












1空机组装和注意事项
我使用的是自由者2300进行装机，和自由者2100差不多，只是机翼长了20cm,机身和尾翼部分是一样的。
1.1机身尾翼部分
机身装配可以参考”手抛固定翼”部分，注意合模前检查需要嵌入的配件是否装完。









为了增加飞机的纵向安定性，我自己的DIY切割了一个垂直尾翼，用热熔胶粘上去。这样飞起来航线的偏移小一些（官方的版本没有配，希望以后能加上）













机翼对接的部分是金属锁钩，注意安装平整，保证插拔顺畅。

机身粘接好以后，建议用纤维胶增加飞机的强度，提高飞机的耐久性。


尾翼在装之前，建议先用手把舵面反复对折动几次，减小舵面转动的阻力。
尾翼舵面也可以用纤维胶加强，增加舵面强度，提高控制的精准度。

1.2机翼部分
机翼的舵面也需要手动反复折叠几次，减小舵面转动的阻力。


检查折叠机臂的螺丝是否拧紧


我装机的是防水防尘版本的电机座，这个电机座内空间可以装下乐天40A和乐天60A电调(电调安装时注意导热散热)。


为了便于快速组装和维修，我把机翼挖了一个洞，自己DIY个转接板进行改装（官方的版本中没得这个东西，希望以后能加上）

我先用3D打印了一个安装底座，便于安装转接板，再用CNC加工了一个盖板，这样外观看起来比较美观。

先预装一下，看看效果怎么样（如果没有转接板需要直接焊接线，有的接头需要剪断然后焊接在一起，效果是一样的）



2飞控系统初始设置
2.1安装mission planer地面站
我使用的是Mission planer改版地面站Mission planer vtol suvey也是永久免费用使的，专门针对垂直起降固定翼优化。

如果插入飞控不能正确识别端口号，需要手动加载驱动。 

垂直起降固定翼航线设计做了大量优化，便于快速生成航线。

高频使用的“空速校准”“拍照”“返航”“自动”“解锁”“跳转航点”全部位于页眉部分方便于使用。

2.2烧写飞控固件
倾转式垂直起降固定翼可以烧写Ardupilot官方固件,也可以烧写Kris版本固件，相对而言Kris版本固件在多旋翼和固定翼之间的转换要平稳一些。
我这里用Kris20190319版本为例加载自定义固件，为了拆装方便，我使用基于Pixhawk V3版本飞控进行系统集成的飞控，名字叫Pixsuvey。
烧写固件的过程和雷迅的Pixhack V3还有赫星的PIXHAWK2是一样的用法。


烧写完固件之后重启检查，是否烧写成功

2.3写入配置参数
倾转式垂直起降固定翼参数可以参考我的参数，也可以自己单独配置。

参数需要刷2次，第一次q_enable使能，重启飞控以后，可以加载q_开头的隐藏参数。
刷第二次的时候q_开头的参数才被成功写入。


2.4六面法校准加速度计
这个校准是必须要做的，相对于加速度计的初始校准，水平校准只是小角度微调。
加速度校准顺序：
水平上放置——左倾90度——右倾90度——低头90度——仰头90度——水平倒放

很多飞机的航线偏移和飞机水平没校准有很大关系（校准飞控的水平按飞机的水平校准）



2.5配置校准磁罗盘
垂直起降固定翼因为有多旋翼的部分需要配置外置罗盘，我是禁用内置罗盘，因为内置罗盘在飞控里面，机舱内的电磁环境比较复杂，电源线、BEC、都可能对罗盘产生干扰。


我使用现场校准，机头指向北方，沿俯仰轴旋转360度，再机头水平旋转90度，再横滚旋转360度，即可完成校准。
一般在室外使用现场校准，需要把把身上的钥匙、手机、皮带扣等含铁物品移除，校准时飞机远离飞机支撑托架和车辆等干扰源。

补偿参数：
在北半球Z的补偿应该是正数，俯仰低头X的补偿值应该增加，横滚向右Y的补偿值应该增加

常见的罗盘报错信息
Compass Health: 罗盘至少有半秒没有发出信号
Compass Variance:在EKF路径中，罗盘的航向与其他惯性传感器的航向估计不一致。点击任务计划界面上的EKF按钮将显示具体错误
Compass Not Calibrated: 罗盘需要校准
Compass Offsets High: 你的一个罗盘偏移量超过600，表明可能受到磁干扰，检查干扰源并再次校准。

2.6配置校准遥控器
设置模式开关通道，我使用的天地飞7遥控，配置通道5三段开关为模式开关。

校准遥控器，按提示把每个通道的值都打到最大和最小，最后油门保持在低位，其他通道都保持在中位。这样飞控完成最大值、最小值和中位值的记录保存。

点击“反转”就是修改遥控器通道的正反，比较方便。和直接修改遥控器通道输出正反是一样的效果。
2.7配置检查GPS
连接GPS检查收星是否正常，我在室内连接，所以卫星数量很少，EKF红色也没消失，GPS还没完全锁定。


大多数民用GPS接收器都使用GPS L1频道(1575.42 MHz)上的伪橙色数据(C/A码)，也可以选择接收SBAS DGPS校正以获得米精度。
先进和昂贵的民用GPS接收器可以使用先前的方法加上载波相位平滑，载波相位校正(RTK)以及L2通道P(Y)码半编码跟踪(1227.60 MHz)，用于实时局部电离层校正，提供厘米甚至毫米精度。
一些更先进的GNSS接收机可以结合DGPS和RTK校正，同时可以接收其他GNSS卫星星座(GLONASS和GALILEO)和其他信道(L2C、L5……)，以提高精度和固定可靠性。
军用GPS接收器能够解码L1和L2信道上可用的P(Y)码，与伪橙色的基本解相比，可以提供10倍的实时精度。
GPS多路径
多路径导致GPS定位误差难以检测和补偿。由于同时有更多的可见卫星，多个GNSS接收器更适合滤除多路径。
GPS干扰信号传播
电离层扰动和磁暴(太阳活动)会导致信号延迟。这可以部分补偿使用SBAS和L1 / L2解码。
同时解码L1和L2信道确实可以通过差分技术实现电离层的实时校正。与SBAS广播电离层改正不同，该方法能较好地匹配电离层的局部条件。
2.8配置检查数传
我比较喜欢使用RFD900数传，有几个优点：
1.传输距离比较远，在新疆地区使用40km以上；
2.直接可以通过地面站修改数传ID，多架飞机可以同时工作；
3.同时方便修改波特率、发射功率、透传模式，不需要单独再接其他软件；


2.9配置检查电流电压模块
我使用的是Pixhawk V3的版本，设置检测电压和电流模式，市面上常见的电源模块只能检测60A，可能会出现超量程的情况，我自己DIY了一个电流计可以检测到99A，满足多旋翼倾转状态下的最大电流检测。
设置好电池容量，这样电池估算的电量百分比才相对比较准确。

2.10配置检查空速计
我使用的是4525D0空速计，I2C接口，配置好接口。空速比例修正要在无风的情况下观察空速和低速差异大不大。如果空速比低速大，减小比例，如果空速比低速小，增加比例。
我使用了空速延长管，我的ARSPD_RATIO=1.59是比较合适的,注意上面是动压管。


校准空速在主界面完成一般空速的值在3以内波动是比较正常的。


2.11配置检查相机快门
相机快门采用继电器触发模式，需要认真把飞控的参数配置正确
CAM_DURATION=2   代表高电平持续时间为0.2S
CAM_RELAY_ON=1   默认为低电平，触发为高电平
CAM_TRIGG_TYPE=1 相机采用继电器触发模式
RELAY_PIN=54       AUX5通道为继电器通道


2.12配置检查SD卡记录是否正常
飞控的SD卡一定要换高速卡，飞控厂家配的卡一定要检查，不然会出现BAD LOG，或者POS数据记录不完整，莫名其妙的日志直接记录不了。
地面站支持在线下载日志，但是数传比较慢，我一般是直接取卡。

3动力系统的安装调试
3.1电池电压检查及充放电
测试时候注意电池不要过放，普压6S电池放电最低电压22.2V，充满电25.2V，长期不使用电池储存电压23V左右，延长电池寿命。

3.2飞控供电电源检查
主要检查飞控供电模块电压一般为5.3V，不同版本的飞控混用，注意电流和电压检测引脚顺序，VCC和GND的顺序。
3.3舵机供电电源检查
主要检查给舵机供电的BEC的电压是否在6V以内，超过6V，银燕ES3054舵机会烧。BEC的供流能力要达到10A以上，避免多个舵机同时工作，舵机供电不足。
注意舵机BEC的供电不能作为数传供电，舵机BEC的纹波很大，会直接把数传烧掉。


3.4数传供电电源检查
为了使用提高电源的稳定性，数传我单独供电，主要有2个原因：
1.数传直接在飞控取电，数传发射瞬间功率比较大，会导致飞控电源纹波增大，电压波动。
2.2.很多厂家的飞控供电模块的供流能力标称3A，有的PCBA 3A都达不到，测试直接拉烧了。
3.5相机假电池电源检查
假电池出厂前都是检查了的，主要排除一些小概率事件，假电池的供电电压12-26V，输出电压8V左右。为相机提供充分续航。

3.6舵机的安装和检查
舵机的检查也是排除小概率事件。舵机供电一般5-6V，使用舵机测试仪，舵机能正常摆动


3.7电机电调的安装和检查
电机电调的检查，主要也是排除小概率故障，检查电机和电调是否能正常工作。
为了方便组装，我自己DIY了几个60A电调，和电机座完美配合。（官方标配是好赢的60A/40A电调）
电调校准：
1.只给飞控上电，电机电调不要上电。如果你的飞控和电机供电不能独立切断，那么你可以使用USB线来给飞控供电。
2.设置Q_ESC_CAL=1时，飞行模式切换到QSTABILIZE，解锁飞控，此时电调PWM输入等于遥控器的油门值，遥控油门推到最大，然后给电调上电，等待电调滴滴响，表明电调识别了最大油门值，油门拉到最低，飞控加锁，你应该听到滴一声，表明电调识别了油门的行程。
3.参数Q_ESC_CAL=1的作用是可以用来测试电机的响应。你可以通过油门直接控制所有旋翼电机。同时你可以使用转速计测试电机在不同油门值下的转速。



3.8连接器线材的焊接
为了接线方便，我使用了14号红黑硅胶线配合2.5-4的冷压端子，直接拧螺丝固定。
我的连接器接线顺序：
A1-电源负极
A2-电源正极
1—副翼舵机信号线60芯（橙色）
2—舵机供电电源60芯（红色）
3—后电机信号线30芯（棕色）
4—倾转舵机信号线30芯（红色）
5—前电机信号线30芯（橙色）

3.9机翼动力部分的安装
ES3054舵机原装线长度不够，我把10CM长的Y线减了1个公头部分，作为延长线用，用卡口固定。

V尾舵机也需要延长，每边舵机需要用1颗自攻螺丝直接固定好



转接板S1 S2 S3 S4分别并联了2路排针，转接板只是转接线的作用，为了装机方便，和直接焊接是一样的效果。

机身的连接器也安装好，机身的连接器我使用的是母头。




电调安装时候，需要先检查一遍正反转，硅胶护套记得穿上。
SERVO9_FUNCTION = 33
SERVO10_FUNCTION = 34
SERVO11_FUNCTION = 35
SERVO12_FUNCTION = 36
SERVO5_FUNCTION = 75
SERVO6_FUNCTION = 76
通道AUX1(CH9)- 右前电机（逆时针旋转）
通道AUX2(CH10)-左后电机（逆时针旋转）
通道AUX3(CH11)-左前电机（顺时针旋转）
通道AUX4(CH12)-左后电机（顺时针旋转）
通道CH5-左倾转舵机
通道CH6-右倾转舵机


焊接完成后，我给PCB上了一层三防漆，主要是绝缘、防尘的作用。

我剪了一块导热硅胶贴上去，热量可以快速传到铝材上，加速散热。



调节好电机线的长度，保证电机水平和垂直状态线长合适。

倾转舵机，出线端两边分别2颗螺丝可以拧下，再直接固定在安装座上面。


4航电设备安装调试
4.1飞控的安装调试

飞控盒用热熔胶固定在EPO飞控舱内，直接按照飞控的接线顺序把线材固定好


4.2 GPS&磁罗盘的安装

罗盘的安装需要注意安装方向，我使用的是默认安装，尽量远离分电板。
4.3空速管的安装和布线
空速管安装在机头位置，主要避免气流的影响。

4.4数传天线的安装
两根数传天线我都采用的竖直安装，主要是因为航测机一般飞得比较高，比较远。

4.5调整舵面的平整度
在手动模式下，舵面应该是平整的，舵机在上下舵面角度我一般控制在30度，30度内的舵面效率非常高。

通过调节对应通道的最大最小输出范围，可以调整舵面控制的角度。

4.6FBWA检查舵面方向
首先检查手动模式下，遥控器控制舵面的方向是否正确。
遥控器输入通道	相应舵面执行的动作
横滚通道往右拨动摇杆	左副翼向下运动，右副翼向上运动
横滚通道往左拨动摇杆	左副翼向上运动，右副翼向下运动
俯仰通道往下拨动摇杆	左尾翼向上运动，右尾翼向上运动
俯仰通道往上拨动摇杆	左尾翼向下运动，右尾翼向下运动
方向通道往左拨动摇杆	左尾翼向下运动，右尾翼向上运动
方向通道往右拨动摇杆	左尾翼向上运动，右尾翼向下运动

再FBWA模式下再检查飞控修正的舵面的方向是否正确。
飞机倾斜方向	舵面动作情况
横滚往右倾斜	左副翼向上运动，右副翼向下运动
横滚往左倾斜	左副翼向下运动，右副翼向上运动
俯仰向上倾斜	左尾翼向下运动，右尾翼向下运动
俯仰向下倾斜	左尾翼向上运动，右尾翼向上运动
方向水平向左运动	左尾翼向上运动，右尾翼向下运动
方向水平向右运动	左尾翼向下运动，右尾翼向上运动
5地面起飞前检查
起飞前检查的步骤是在室外进行的，主要是排查飞机起飞前的隐患，尽可能减小在空中出现故障的概率。
5.1检查磁罗盘
飞控通电启动的时候，不要移动飞机，飞控在自检，直到听到1-2-3的声音，表示飞控启动成功。先把机头指到北方，检查实际方向和飞机机头方向的误差。
误差一般3度以内可以接受，出现偏差较大，需要在室外按照之前的步骤再次校准罗盘。
飞机的罗盘在多旋翼时候误差太大，会导致多旋翼电机输出不稳定，飞机机头甩动。
飞机的罗盘在固定翼时候误差太大，会导致飞机在直航线上，整体轨迹左偏或者右偏。
校准好罗盘后，在地面上模拟飞机左右大角度转弯，大角度俯仰，显示器EKF的罗盘部分，不显示红色，不显示黄色，一直保持绿色的部分。
5.2检查飞机重心
检查重心时，需要把前电机都掰到水平位置，飞机重心以固定翼的为准。
自由者2100和2300的重心略微不同，请注意区分。

自由者2100重心—位于机翼翼根塑料件下凸起处沿尾翼方向移动5mm.

自由者2300重心—位于机翼翼根塑料件下凸起处沿尾翼方向移动15mm.


5.3检查倾转舵机是否抖动
把飞机切换到q_stable模式（多轴增稳），需要2人把飞机机翼按住，按下飞控安全开关，解锁电机，然后推油，电机开始旋转，油门一般控制在40%-80%之间，观察倾转舵机是否有前后摆动等异常情况。
如果倾转舵机出现抽动，可能的原因：
1.排查数传天线对倾转舵机信号线干扰；
2.倾转舵机的摇臂螺丝拧得太紧，导致舵机静止时也有较大负载，导致电源波动。
3.排查舵机供电BEC，在电池大电流放电的情况下，导致BEC输出波动比较大。
4.把飞控切换到手动模式，正常情况下副翼、尾翼舵机是不会有异响的，如果出现异响，一般就是前电机在水平时候导致倾转舵机持续受力引起的。

5.3检查空速达到后是否倾转
主要是检查舵机的倾转功能是否正常。注意需要在拆除螺旋桨的情况下进行。
飞控上电，遥控器切到q_stable模式，按下安全开关，解锁电机，电机开始旋转，油门到60%左右，切换到FBWA模式，可以看到倾转舵机开始倾转到固定角度，倾转的角度由Q_TILT_MAX控制，我设置的35度，是倾转与垂直的角度，倾转的速率由Q_TILT_RATE_DN控制，我设置的是10度每秒，倾转35度，大约需要3.5S。
然后我们向空速管里面吹气，可以看到空速升高，Q_ASSIST_SPEED 我设置的是14，当空速达到14m/s以后，Q_TRANSITION_MS持续时间3S以后，倾转舵机开始转为固定翼模式。
当空速低于14m/s，倾转舵机又回到35度多轴加速前进状态。

Q_ASSIST_ANGLE是飞机切为多旋翼加速状态的保护角度，我设置的是45度。当飞机在FBWA、AUTO模式下飞行，遇到大风，飞机姿态倾斜超过45度，多轴保护就会起作用。


5.4多旋翼矢量功能
多旋翼矢量主要是提高多旋翼模式下飞机的抗风能力，前面两个电机可以矢量上下移动。
飞控上电后切换到q_stable模式，按下飞控安全开关，注意不要解锁，油门推到30%左右，电机不转。打遥控器的方向舵，我们可以看到前后两个舵机还是差动。
Q_TILT_YAW_ANGLE参数控制舵机矢量的角度，我设置的是10度，角度不要太大，不然桨容易砍到碳管。

5.5固定翼矢量功能
固定翼矢量功能我一般是关闭的，主要是2个参数控制:Q_TILT_FIX_ANGLE
控制角度，Q_TILT_FIX_GAIN控制感度，可以简单理解为控制倾转的快慢。矢量可以辅助固定翼舵面修正,舵失效仍有一定的控制能力。
   测试方法：暂时设置下面2个参数
Q_TILT_FIX_ANGLE=10(固定翼矢量角度,0=关,10=10度)
Q_TILT_FIX_GAIN=100(固定翼矢量感度,0=关,100=100%)
切换到手动模式,推油门(不要解锁),打升降舵试角度(会同上同下),打副翼试角度(会一前一后)
切换到FBWA模式,推油门(不要解锁),机身往前倾则舵机角度朝上,往右倾则舵机角度往上
6低空多旋翼测试
低空多旋翼测试主要测试多轴部分飞机的稳定性
6.1电机转向测试
电机转向如果出现错误，多旋翼飞不起来，飞机在地面上打滚。起飞前一定要检查电机的转向和桨的方向。
电机测试输入油门10%-15%，测试电机ABCD，电机按右前A—右后B—左后C—左前D的顺序启动。
如果电机旋转方向不对，需要手动交换任意2根电机线。
设置电机启动怠速参数：
Q_M_SPIN_ARM=0.1


6.2横滚PID调试
横滚是由2级串型PID控制的。
一般先调外环的参数：
Q_A_ANG_RLL_P=8表示实际横滚角度与期望角度的误差增益，现象就是值越大，飞机修正的力度就越大。

如果飞机不容易调稳定，需要调内环参数：
Q_A_RAT_RLL_D=0.006 表示微分。横滚轴开始高频小幅度振荡，就是这个值偏大了，调试的时候参数的0较多，注意不要输错了。
Q_A_RAT_RLL_I=0.3表示积分。这个值一般不超过对应的P值。比如说多轴状态我打横滚15度（摇杆打完，角度限制在15度Q_ANGLE_MAX=1500），但是飞机一直稳定在14度就不上去了，这种情况下就需要增加I值。
Q_A_RAT_RLL_P=0.3表示比例。值越大，电机输出的力度就越大，值太大的话， 飞机会出现低频大幅度振荡。

在机架允许的范围的，同一架飞机可以调出多组感度由大到小的参数。




6.3俯仰PID调试
俯仰是由2级串型PID控制的。
一般先调外环的参数：
Q_A_ANG_PIT_P=6表示实际俯仰角度与期望角度的误差增益，现象就是值越大，飞机修正的力度就越大。

如果飞机不容易调稳定，需要调内环参数：
Q_A_RAT_PIT_D=0.006 表示微分。俯仰轴开始高频小幅度振荡，就是这个值偏大了，调试的时候参数的0较多，注意不要输错了。
Q_A_RAT_PIT_I=0.3表示积分。这个值一般不超过对应的P值。比如说多轴状态我打俯仰15度（摇杆打完，角度限制在15度Q_ANGLE_MAX=1500），但是飞机一直稳定在14度就不上去了，这种情况下就需要增加I值，消除稳定误差。
Q_A_RAT_PIT_P=0.3表示比例。值越大，电机输出的力度就越大，值太大的话， 飞机会出现低频大幅度振荡，值太小，飞机表现得比较软，抗风性能不好。

在机架允许的范围的，同一架飞机可以调出多组感度由大到小的参数。

6.4方向PID调试
俯仰是由2级串型PID控制的。
一般先调外环的参数：
Q_A_ANG_YAW_P=5表示实际方向角度与期望方向角度的误差增益，现象就是值越大，飞机修正的力度就越大。

如果飞机不容易调稳定，需要调内环参数：
Q_A_RAT_YAW_D=0.001 表示微分。方向轴开始高频小幅度振荡，就是这个值偏大了，调试的时候参数的0较多，注意不要输错了。
Q_A_RAT_YAW_I=0.16表示积分。这个值一般不超过P值。比如说多轴状态我打方向5度，我松摇杆，但是飞机方向会回到4度，在空中可以看到这种明显变化。这种情况下就需要增加I值，消除稳定误差。
Q_A_RAT_YAW_P=0.16表示比例。值越大，电机输出的力度就越大，值太大的话， 飞机会出现低频大幅度振荡，值太小，打方向，飞机不怎么转向。

在机架允许的范围的，同一架飞机可以调出多组感度由大到小的参数。
6.5遥控多轴需要调的几个参数
在q_loiter模式下，

Q_LOIT_BRK_ACCEL=100刹车（例如摇杆回中）时的最大加速度，单位cm/s/s，更高的数值使得飞机停止更快。
Q_LOIT_BRK_DELAY=0.5S当摇杆回中时，开始刹车的延时时间，单位秒。
6.6飞控震动检查
Vibe1,Vibe2,Vibe3这三个参数在30以内都是正常的。
6.7磁罗盘干扰检查
这里检查磁罗盘干扰，主要排除空中飞行过程罗盘是否正常。正常情况下MagX,MagY，MagZ的值在600以内都是正常的。


7空中遥控飞行
7.1固定翼自动调参


固定翼的调参和手抛机的部分是一样的。
AUTOTUNE_LEVEL=6值越大，飞机的增益越大，飞机的响应速度越快。
先手动起飞，飞行到60-80米切换到“AUTOTUN”模式，现在横滚和俯仰有一点增稳作用，但不是很合适，可能不好飞，不用慌。
自动调参校准横滚，快速地拨动横滚摇杆的向左打到底，再向右打到底，连续拨动20下，只要飞机不掉下来，快速拨杆打舵，慢慢地你会发现飞机的横滚增稳有改善。觉得不合适，再重复几次。
自动调参校准俯仰，建议先把飞机飞高一些，免得救机的高度不够，快速拨动俯仰摇杆最上到最下，连续20次，可以看到飞机飞波浪线，回中后逐渐会发现飞机的俯仰有改善，如果没得改善继续校准。
校准完成后切换到FBWA模式下，感受飞机的操控状态，直到自己满意为止。
每个飞机的遥控器行程不一样、舵机中位不一样、连杆到舵面的位置不一样，飞机的起飞重量不一样等因数，导致每个飞机自动调参后的PID都有细微差异，这个是正常的。
注意：固定翼调参后的参数值，一般偏大，可能超出范围，可以适当改小一些。

7.2多旋翼到固定翼的切换
首先我使用q_loiter多轴定点模式起飞，为了防止倾转的时候掉高。可以爬到40-50米。切换到FBWA模式，这时候飞机加速前进，遥控器控制不了飞机的副翼和俯仰，不要慌!一定要推油门飞机才能自动完成切换。切换过程需要的距离大约在100-200米左右。切换完成后，飞机的控制和固定翼的FBWA的感觉是一样的。
可以在空中多次q_loiter和FBWA模式之间切换，感受飞机的切换过程有无异常。
在FBWA一切正常的情况下，减小油门，故意让飞机失速低于14m/s,观察飞机是否切换到多轴辅助模式。
在FBWA一切正常的情况下，减小油门，拉杆，故意让飞机失速并且侧翻。侧翻角度大于45度,观察飞机是否切换到多轴辅助模式。

8地面站自动飞行
8.1起降航线测试
起降航线主要测试飞机自动起降情况下是否正常。

需要使用几个命令：
VTOL_TAKEOFF多旋翼模式起飞，高度设置40米
RETURN_TO_LAUNCH返航


如果多旋翼起飞升高速度太快，可以调节这个参数Q_VELZ_MAX=150我设置的多轴爬升速度是1.5m/s。
多轴转固定翼倾转的时候如果掉高，可以改这几个参数：
Q_TILT_THR_DN=90向下倾转的油门可以增大
Q_TILT_MAX=35向下倾转加速角度可以改小
Q_TILT_RATE_DN=10向下倾转的速率为10deg/s

固定翼转多轴的时候如果爬高，可以改下面几个参数：
Q_TILT_RATE_UP=60向上倾转的舵机速率可以减小
Q_TILT_THR_UP=15向上倾转的油门大小可以减小

返航固定翼变多轴悬停的位置如果超过HOME点，说明飞机的刹车力度不够，可以改下面参数
Q_TRANS_DECEL=4值越大表示刹车力度越大

多轴下降的速度和上升的速度都是同一个参数控制的：
Q_VELZ_MAX=150多轴上升和下降速度是1.5m/s

设置多旋翼二级降落的高度和速度参数：
Q_LAND_FINAL_ALT=6据地面6米的时候采用二级降落速度
Q_LAND_SPEED=40二级降落的速度是0.4m/s

降落完成后让飞机快速上锁的参数：
Q_LAND_DETECT=3

上锁完成后，让所有舵面归中的参数：
LAND_THEN_NEUTRL=1


8.2矩形无限循环航线测试
矩形航线主要测试飞机在直航线上，压航线是否精准。

在这个航线里面，我使用了跳转命令DO_JUNP
#4代表：#8之后，自动跳转到#4
-1代表：无限循环

在这个航点里面，我设计了一个返航航线#10和#11，当我想让飞机降下来的时候，就可以设置跳转命令到#10点，解除无限循环。

这个是跳转到指定航点功能:


如果出现实际轨迹和航线偏移的情况，按照下面的顺序进行检查：
1.手动模式检查尾翼和俯仰舵面是否水平，腹鳍是否安装垂直；
2.固定翼模式下电机安装是否水平
3.罗盘是否异常，GPS是否完全固定后再起飞
4.在飞机通电自检的过程中是否移动了飞机
5.飞控的加速度水平校准是否正确
8.3相机拍照测试
相机拍照测试主要是为了检查飞机的拍照功能是否正常，相机安装座固定得是否合适，POS数据和照片数据数量上保持一致。
检查相机SD卡是否空间足够，是否是高速卡，检查快门设置1/1000S。检查手动拍照，检查相机是否正常工作。
接好电池和快门线，地面站点击“拍照”，能否听到相机的快门声。


检查完毕后，可以使用起降航线添加拍照命令，就可以在航线上自动拍照了。
DO_SET_CAM_TRIGG_DIST=40表示40米等距拍照一次
DO_SET_CAM_TRIGG_DIST=0表示关闭拍照命令

起降完成后，首先检查照片数量30张（只算空中的部分，地面上的不算）

我在机身上开了一个洞，方便取内存卡

接下来点击地面站“POS提取”—导入.bin文件—点击POS点提取——保存
就可以保存需要的POS数据了。


POS的数量也是30张，刚好吻合。

到这里整个垂起的组装和调试就完成了。在实际飞行过程中，还会遇到各种各样的问题，有的是硬件设备引起的，有的是飞控软件不完善引起的，还有的是调试和使用不当出现的。
无论何时无论何地永远对飞行充满热爱和敬畏，遇到问题一定要解决问题，总结经验，不断进步前行。
最后祝所有的飞机都能翱翔在蓝天之上。